# Load Testing Scenarios for <15ms SLA Validation
# Comprehensive test scenarios that validate production performance under realistic load

scenarios:
  # Ultra-fast response validation (targeting <5ms)
  - name: "Ultra-Fast Response Validation"
    description: "Validate ultra-fast <5ms responses for cached endpoints"
    duration_seconds: 180
    concurrent_users: 25
    requests_per_user: 200
    ramp_up_seconds: 15
    sla_threshold_ms: 5.0
    expected_success_rate: 99.5
    cache_warmup: true
    realistic_delays: true
    target_endpoints:
      - "/health"
      - "/api/v1/sales/quick-stats"
      - "/api/v1/analytics/cached-dashboard"
      - "/api/v1/datamart/quality-summary"
    request_patterns:
      cache_hit_ratio: 0.95
      data_size: "small"
      think_time_ms: 50
      user_behavior: "power_user"

  # Production load simulation for <15ms SLA
  - name: "Production Load <15ms SLA"
    description: "Simulate realistic production traffic under <15ms SLA"
    duration_seconds: 600
    concurrent_users: 150
    requests_per_user: 100
    ramp_up_seconds: 60
    sla_threshold_ms: 15.0
    expected_success_rate: 99.0
    cache_warmup: true
    realistic_delays: true
    target_endpoints:
      - "/api/v1/sales/analytics"
      - "/api/v2/analytics/advanced-analytics"
      - "/api/v1/datamart/quality-metrics"
      - "/api/v1/mobile/analytics"
      - "/api/v1/ai/conversation-analytics"
    request_patterns:
      cache_hit_ratio: 0.75
      data_size: "medium"
      think_time_ms: 400
      user_behavior: "typical_user"

  # Peak traffic stress test
  - name: "Peak Traffic Stress Test"
    description: "Test performance under peak traffic conditions"
    duration_seconds: 900
    concurrent_users: 400
    requests_per_user: 50
    ramp_up_seconds: 120
    sla_threshold_ms: 15.0
    expected_success_rate: 95.0
    cache_warmup: true
    realistic_delays: true
    target_endpoints:
      - "/api/v1/sales/analytics"
      - "/api/v2/analytics/advanced-analytics"
      - "/api/v1/ml/predictions"
      - "/api/v1/streaming/real-time-data"
      - "/api/v1/datamart/complex-queries"
    request_patterns:
      cache_hit_ratio: 0.65
      data_size: "large"
      think_time_ms: 200
      user_behavior: "heavy_user"

  # Mobile-specific performance validation
  - name: "Mobile Performance Validation"
    description: "Validate mobile-optimized endpoints under load"
    duration_seconds: 300
    concurrent_users: 80
    requests_per_user: 75
    ramp_up_seconds: 30
    sla_threshold_ms: 10.0  # Stricter for mobile
    expected_success_rate: 99.0
    cache_warmup: true
    realistic_delays: true
    target_endpoints:
      - "/api/v1/mobile/analytics"
      - "/api/v1/mobile/dashboard"
      - "/api/v1/sales/mobile-optimized"
      - "/api/v1/mobile/quick-insights"
    request_patterns:
      cache_hit_ratio: 0.90  # Mobile should have high cache efficiency
      data_size: "small"
      think_time_ms: 300
      user_behavior: "mobile_user"

  # AI/LLM Analytics performance test
  - name: "AI/LLM Analytics Performance"
    description: "Test AI/LLM endpoints for conversational analytics"
    duration_seconds: 450
    concurrent_users: 60
    requests_per_user: 40
    ramp_up_seconds: 45
    sla_threshold_ms: 15.0
    expected_success_rate: 98.0
    cache_warmup: true
    realistic_delays: true
    target_endpoints:
      - "/api/v1/ai/conversation-analytics"
      - "/api/v1/ai/sentiment-analysis"
      - "/api/v1/llm/quick-insights"
      - "/api/v1/ai/recommendations"
    request_patterns:
      cache_hit_ratio: 0.60  # AI requests less cacheable
      data_size: "medium"
      think_time_ms: 800
      user_behavior: "analyst_user"

  # Business intelligence dashboard load
  - name: "BI Dashboard Load Test"
    description: "Test business intelligence dashboards under concurrent load"
    duration_seconds: 720
    concurrent_users: 200
    requests_per_user: 60
    ramp_up_seconds: 90
    sla_threshold_ms: 15.0
    expected_success_rate: 99.0
    cache_warmup: true
    realistic_delays: true
    target_endpoints:
      - "/api/v1/sales/dashboard-data"
      - "/api/v1/analytics/executive-summary"
      - "/api/v1/sales/revenue-analytics"
      - "/api/v1/analytics/performance-kpis"
    request_patterns:
      cache_hit_ratio: 0.80
      data_size: "medium"
      think_time_ms: 600
      user_behavior: "executive_user"

  # Real-time streaming data validation
  - name: "Real-time Streaming Performance"
    description: "Validate real-time streaming endpoints performance"
    duration_seconds: 300
    concurrent_users: 50
    requests_per_user: 120
    ramp_up_seconds: 20
    sla_threshold_ms: 10.0  # Real-time needs lower latency
    expected_success_rate: 97.0
    cache_warmup: false  # Real-time data shouldn't be heavily cached
    realistic_delays: false  # Real-time users don't wait
    target_endpoints:
      - "/api/v1/streaming/real-time-metrics"
      - "/api/v1/streaming/live-dashboard"
      - "/api/v1/streaming/event-stream"
    request_patterns:
      cache_hit_ratio: 0.30  # Low cache for real-time
      data_size: "small"
      think_time_ms: 100
      user_behavior: "realtime_user"

  # ML Operations performance test
  - name: "ML Operations Performance"
    description: "Test ML prediction and model serving endpoints"
    duration_seconds: 480
    concurrent_users: 100
    requests_per_user: 80
    ramp_up_seconds: 60
    sla_threshold_ms: 15.0
    expected_success_rate: 98.0
    cache_warmup: true
    realistic_delays: true
    target_endpoints:
      - "/api/v1/ml/predictions"
      - "/api/v1/ml/model-inference"
      - "/api/v1/ml/batch-scoring"
      - "/api/v1/ml/feature-engineering"
    request_patterns:
      cache_hit_ratio: 0.45  # ML predictions moderately cacheable
      data_size: "large"
      think_time_ms: 500
      user_behavior: "data_scientist"

  # Data quality monitoring load
  - name: "Data Quality Monitoring Load"
    description: "Test data quality monitoring under continuous load"
    duration_seconds: 360
    concurrent_users: 40
    requests_per_user: 150
    ramp_up_seconds: 30
    sla_threshold_ms: 12.0
    expected_success_rate: 99.0
    cache_warmup: true
    realistic_delays: true
    target_endpoints:
      - "/api/v1/datamart/quality-metrics"
      - "/api/v1/datamart/data-lineage"
      - "/api/v1/datamart/quality-alerts"
      - "/api/v1/datamart/validation-results"
    request_patterns:
      cache_hit_ratio: 0.70
      data_size: "medium"
      think_time_ms: 250
      user_behavior: "data_engineer"

  # Endurance test for sustained performance
  - name: "24-Hour Endurance Simulation"
    description: "Simulate sustained load over extended period"
    duration_seconds: 3600  # 1 hour simulation of 24-hour load
    concurrent_users: 75
    requests_per_user: 500
    ramp_up_seconds: 180
    sla_threshold_ms: 15.0
    expected_success_rate: 98.0
    cache_warmup: true
    realistic_delays: true
    target_endpoints:
      - "/api/v1/sales/analytics"
      - "/api/v1/analytics/dashboard"
      - "/api/v1/datamart/quality-metrics"
      - "/api/v1/mobile/analytics"
      - "/health"
    request_patterns:
      cache_hit_ratio: 0.80
      data_size: "mixed"
      think_time_ms: 1000
      user_behavior: "varied_users"

# Global configuration
global_config:
  # Request timeout settings
  request_timeout_seconds: 30
  connection_timeout_seconds: 10
  
  # Monitoring settings
  progress_report_interval_seconds: 10
  real_time_monitoring: true
  
  # Data collection
  collect_detailed_metrics: true
  enable_response_validation: true
  
  # Thresholds for alerts during testing
  alert_thresholds:
    sla_violation_rate_percent: 10  # Alert if >10% violations
    error_rate_percent: 5          # Alert if >5% errors
    response_time_p95_ms: 20       # Alert if P95 >20ms
  
  # Business value context
  business_stories:
    "sales": 2.5e6      # BI Dashboards story value
    "analytics": 2.1e6   # API Performance story value
    "mobile": 2.8e6      # Mobile Analytics story value
    "ai": 3.5e6          # AI/LLM Analytics story value
    "ml": 6.4e6          # ML Operations story value
    "datamart": 1.8e6    # Data Quality story value
    "streaming": 3.4e6   # Real-time Streaming story value

# Test environment configurations
environments:
  development:
    base_url: "http://localhost:8000"
    max_concurrent_requests: 500
    enable_debug_logging: true
    
  staging:
    base_url: "https://staging-api.pwc.com"
    max_concurrent_requests: 1000
    enable_debug_logging: false
    
  production:
    base_url: "https://api.pwc.com"
    max_concurrent_requests: 2000
    enable_debug_logging: false
    require_authentication: true